<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 6 Independencia de variables categóricas | Apuntes de estadística</title>
<meta name="author" content="Francisco Javier Barón López">
<meta name="description" content="Las tablas de contingencia se utilizan para examinar la relación entre dos variables categóricas, o bien explorar la distribución que posee una variable categórica entre diferentes muestras. Hay...">
<meta name="generator" content="bookdown 0.30 with bs4_book()">
<meta property="og:title" content="Capítulo 6 Independencia de variables categóricas | Apuntes de estadística">
<meta property="og:type" content="book">
<meta property="og:description" content="Las tablas de contingencia se utilizan para examinar la relación entre dos variables categóricas, o bien explorar la distribución que posee una variable categórica entre diferentes muestras. Hay...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 6 Independencia de variables categóricas | Apuntes de estadística">
<meta name="twitter:description" content="Las tablas de contingencia se utilizan para examinar la relación entre dos variables categóricas, o bien explorar la distribución que posee una variable categórica entre diferentes muestras. Hay...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.1/transition.js"></script><script src="libs/bs3compat-0.4.1/tabs.js"></script><script src="libs/bs3compat-0.4.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Apuntes de estadística</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introducción</a></li>
<li class="book-part">Curso estadística básica</li>
<li><a class="" href="exploraci%C3%B3n-de-los-datos.html"><span class="header-section-number">1</span> Exploración de los datos</a></li>
<li><a class="" href="estimaci%C3%B3n.html"><span class="header-section-number">2</span> Estimación</a></li>
<li><a class="" href="contrastes-de-hip%C3%B3tesis.html"><span class="header-section-number">3</span> Contrastes de hipótesis</a></li>
<li><a class="" href="diferencias-que-presenta-una-variable-num%C3%A9rica-entre-dos-grupos.html"><span class="header-section-number">4</span> Diferencias que presenta una variable numérica entre dos grupos</a></li>
<li><a class="" href="diferencias-que-presenta-una-variable-num%C3%A9rica-entre-varios-grupos.html"><span class="header-section-number">5</span> Diferencias que presenta una variable numérica entre varios grupos</a></li>
<li><a class="active" href="independencia-de-variables-categ%C3%B3ricas.html"><span class="header-section-number">6</span> Independencia de variables categóricas</a></li>
<li class="book-part">Curso estadística avanzada</li>
<li><a class="" href="regresi%C3%B3n-lineal-m%C3%BAltiple.html"><span class="header-section-number">7</span> Regresión lineal múltiple</a></li>
<li><a class="" href="regresi%C3%B3n-log%C3%ADstica-binaria.html"><span class="header-section-number">8</span> Regresión logística binaria</a></li>
<li><a class="" href="taller-de-regresi%C3%B3n-lineal.html">Taller de regresión lineal</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/fjbaron/apuntesMaster">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="independencia-de-variables-categóricas" class="section level1" number="6">
<h1>
<span class="header-section-number">Capítulo 6</span> Independencia de variables categóricas<a class="anchor" aria-label="anchor" href="#independencia-de-variables-categ%C3%B3ricas"><i class="fas fa-link"></i></a>
</h1>
<p>Las tablas de contingencia se utilizan para examinar la relación entre dos variables categóricas, o bien explorar la distribución que posee una variable categórica entre diferentes muestras.</p>
<p>Hay diferentes cuestiones que surgen al examinar una tabla de contingencia, y en este tema vamos a tratar la cuestión de la independencia.</p>
<p>La independencia de dos variables consiste en que la distribución de una de las variables es similar sea cual sea el nivel que examinemos de la otra. Esto se traduce en una tabla de contingencia en que las frecuencias de las filas (y las columnas) son aproximadamente proporcionales. Esto es equivalente a observar que los porcentajes por columnas(o filas) son similares.</p>
<p>La prueba de independencia <span class="math inline">\(\chi^2\)</span> (chi-cuadrado) contrasta la hipótesis de que las variables son independientes, frente a la hipótesis alternativa de que una variable se distribuye de modo diferente para diversos niveles de la otra.</p>
<div id="ejemploprioridades-en-niños-y-sexo" class="section level3 unnumbered">
<h3>Ejemplo:Prioridades en niños y sexo<a class="anchor" aria-label="anchor" href="#ejemploprioridades-en-ni%C3%B1os-y-sexo"><i class="fas fa-link"></i></a>
</h3>
<p>Vamos a usar la base de datos <a href="datos/coolKids.sav">coolKids.sav</a> donde se recogen las respuestas de unos escolares de 10 a 12 años a los que se les preguntó, entre otras cosas, a qué daban más prioridad de entre tres posibilidades: Tener buenas notas, destacar en los deportes o ser popular entre los compañeros. Examinemos las primeras líneas de la base de datos:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span><span class="op">=</span><span class="fu">read_sav</span><span class="op">(</span><span class="st">"datos/coolKids.sav"</span>, user_na<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">haven</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="op">)</span> </span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
Sexo
</th>
<th style="text-align:right;">
Curso
</th>
<th style="text-align:right;">
Edad
</th>
<th style="text-align:left;">
Raza
</th>
<th style="text-align:left;">
Entorno
</th>
<th style="text-align:left;">
Escuela
</th>
<th style="text-align:left;">
Metas
</th>
<th style="text-align:right;">
Notas
</th>
<th style="text-align:right;">
Deportes
</th>
<th style="text-align:right;">
Apariencia
</th>
<th style="text-align:right;">
Dinero
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Varón
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
Blanco
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:left;">
Elm
</td>
<td style="text-align:left;">
Deportes
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Varón
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
Blanco
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:left;">
Elm
</td>
<td style="text-align:left;">
Popular
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Mujer
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
Blanco
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:left;">
Elm
</td>
<td style="text-align:left;">
Popular
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
</tr>
<tr>
<td style="text-align:left;">
Mujer
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
Blanco
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:left;">
Elm
</td>
<td style="text-align:left;">
Popular
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:left;">
Mujer
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
Blanco
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:left;">
Elm
</td>
<td style="text-align:left;">
Popular
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;">
Mujer
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:left;">
Blanco
</td>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:left;">
Elm
</td>
<td style="text-align:left;">
Popular
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
3
</td>
</tr>
</tbody>
</table></div>
<p>Vamos a estudiar por sexos si por <em>sexo</em> hay diferencias en la distribución de las <em>metas</em>:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">generaTablaChi2PorGrupo</span><span class="op">(</span>vGrupo <span class="op">=</span> <span class="st">"Sexo"</span>,vCuali <span class="op">=</span> <span class="st">"Metas"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span><span class="fu">collapse_rows</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,valign <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
Variable
</th>
<th style="text-align:left;">
Valores
</th>
<th style="text-align:left;">
Varón
</th>
<th style="text-align:left;">
Mujer
</th>
<th style="text-align:left;">
p
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Metas
</td>
<td style="text-align:left;">
Notas
</td>
<td style="text-align:left;">
51.5(117)
</td>
<td style="text-align:left;">
51.8(130)
</td>
<td style="text-align:left;">
&lt;0.001*
</td>
</tr>
<tr>
<td style="text-align:left;">
Metas
</td>
<td style="text-align:left;">
Popular
</td>
<td style="text-align:left;">
22.0(50)
</td>
<td style="text-align:left;">
36.3(91)
</td>
<td style="text-align:left;">
&lt;0.001*
</td>
</tr>
<tr>
<td style="text-align:left;">
Metas
</td>
<td style="text-align:left;">
Deportes
</td>
<td style="text-align:left;">
26.4(60)
</td>
<td style="text-align:left;">
12.0(30)
</td>
<td style="text-align:left;">
&lt;0.001*
</td>
</tr>
</tbody>
</table></div>
<p>La significación que se observa en la tabla (p), es la de la prueba Chi-cuadrado. Nos indica que las diferencias en porcentajes que se aprecian en las columnas de niños y niñas van más allá de lo que se esperaría que ocurriese por puro azar.</p>
<p>Con un poco de atención se observa porcentajes similares de niños y niñas en cuanto a la importancia que tienen para ellos las notas. Donde más diferencia se observa entre los sexos es en la preferencia que muestran muchos chicos por los deportes y muchas chicas por la popularidad.</p>
<p>Gráficamente podríamos mostrarlo con diagramas de barras apiladas:</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dftmp</span><span class="op">=</span><span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">Sexo</span>,<span class="va">Metas</span><span class="op">)</span>  <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>cuenta<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">Sexo</span>,<span class="va">Metas</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">tally</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>fraccion<span class="op">=</span><span class="va">n</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">dftmp</span>, <span class="fu">aes</span><span class="op">(</span>fill<span class="op">=</span><span class="va">Metas</span>, y<span class="op">=</span><span class="va">fraccion</span>, x<span class="op">=</span><span class="va">Sexo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">geom_bar</span><span class="op">(</span> stat<span class="op">=</span><span class="st">"identity"</span>, position<span class="op">=</span><span class="st">"fill"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-chi2_files/figure-html/unnamed-chunk-4-1.png" width="672"></div>
<p>Otra forma interesante de mostrarlo consiste en utilizar <em>gráficos de mosaicos</em>, donde se utiliza un área para cada combinación de las dos variables, proporcional a las frecuencias observadas. Observe que son ligeramente más anchos los mosaicos de las mujeres que los de los varones. Esto refleja que en el estudio participa una cantida liéramente mayor de hombres que de mujeres.</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">geom_mosaic</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">product</span><span class="op">(</span><span class="va">Metas</span>,<span class="va">Sexo</span><span class="op">)</span>, fill<span class="op">=</span><span class="va">Metas</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Sexo"</span>, y<span class="op">=</span><span class="st">"Metas"</span>,title<span class="op">=</span><span class="st">'Metas por Sexo'</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-chi2_files/figure-html/unnamed-chunk-5-1.png" width="672"></div>
<p>Usando SPSS podemos conseguir tanto las frecuencias como los porcentajes y resultado de la prueba chi-cuadrado en el menú:
“Analizar - Estadísticos descriptivos - Tablas de contingencia…”. Allí situamos en columnas la variable <em>Sexo</em>, y en filas ponemos <em>Metas</em>. En el botón <em>Casillas</em> marcamos los <em>porcentajes por columnas</em>. En el botón “Estadísticos…” para marcar seleccionamos la prueba <em>chi-cuadrado de Pearson</em>.</p>
<p>Podríamos afinar más nuestro estudio y ver si estas diferencias entre niños y niñas se presentan también según el <em>Entorno</em> (urbano, suburbano o rural) de los niños. Para ello podríamos realizar una prueba chi-cuadrado en cada entorno:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">%&gt;%</span> <span class="fu">generaTablaChi2PorGrupo_Tiempo</span><span class="op">(</span>vGrupo <span class="op">=</span> <span class="st">"Sexo"</span>, vCuali <span class="op">=</span> <span class="st">"Metas"</span>, vTiempo <span class="op">=</span> <span class="st">"Entorno"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>booktabs<span class="op">=</span><span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span><span class="fu">collapse_rows</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,valign <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-table"><table class="table table-sm">
<thead><tr>
<th style="text-align:left;">
Tiempo
</th>
<th style="text-align:left;">
Valores
</th>
<th style="text-align:left;">
Varón
</th>
<th style="text-align:left;">
Mujer
</th>
<th style="text-align:left;">
p
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:left;">
Notas
</td>
<td style="text-align:left;">
31.8(21)
</td>
<td style="text-align:left;">
43.4(36)
</td>
<td style="text-align:left;">
0.025*
</td>
</tr>
<tr>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:left;">
Popular
</td>
<td style="text-align:left;">
28.8(19)
</td>
<td style="text-align:left;">
37.3(31)
</td>
<td style="text-align:left;">
0.025*
</td>
</tr>
<tr>
<td style="text-align:left;">
Rural
</td>
<td style="text-align:left;">
Deportes
</td>
<td style="text-align:left;">
39.4(26)
</td>
<td style="text-align:left;">
19.3(16)
</td>
<td style="text-align:left;">
0.025*
</td>
</tr>
<tr>
<td style="text-align:left;">
Suburbano
</td>
<td style="text-align:left;">
Notas
</td>
<td style="text-align:left;">
57.3(51)
</td>
<td style="text-align:left;">
58.1(36)
</td>
<td style="text-align:left;">
0.030*
</td>
</tr>
<tr>
<td style="text-align:left;">
Suburbano
</td>
<td style="text-align:left;">
Popular
</td>
<td style="text-align:left;">
22.5(20)
</td>
<td style="text-align:left;">
35.5(22)
</td>
<td style="text-align:left;">
0.030*
</td>
</tr>
<tr>
<td style="text-align:left;">
Suburbano
</td>
<td style="text-align:left;">
Deportes
</td>
<td style="text-align:left;">
20.2(18)
</td>
<td style="text-align:left;">
6.5(4)
</td>
<td style="text-align:left;">
0.030*
</td>
</tr>
<tr>
<td style="text-align:left;">
Urbano
</td>
<td style="text-align:left;">
Notas
</td>
<td style="text-align:left;">
62.5(45)
</td>
<td style="text-align:left;">
54.7(58)
</td>
<td style="text-align:left;">
0.003*
</td>
</tr>
<tr>
<td style="text-align:left;">
Urbano
</td>
<td style="text-align:left;">
Popular
</td>
<td style="text-align:left;">
15.3(11)
</td>
<td style="text-align:left;">
35.8(38)
</td>
<td style="text-align:left;">
0.003*
</td>
</tr>
<tr>
<td style="text-align:left;">
Urbano
</td>
<td style="text-align:left;">
Deportes
</td>
<td style="text-align:left;">
22.2(16)
</td>
<td style="text-align:left;">
9.4(10)
</td>
<td style="text-align:left;">
0.003*
</td>
</tr>
</tbody>
</table></div>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">geom_mosaic</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="fu">product</span><span class="op">(</span><span class="va">Metas</span>,<span class="va">Sexo</span><span class="op">)</span>, fill<span class="op">=</span><span class="va">Metas</span><span class="op">)</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span></span>
<span>   <span class="fu">labs</span><span class="op">(</span>x<span class="op">=</span><span class="st">"Sexo"</span>, y<span class="op">=</span><span class="st">"Metas"</span>,title<span class="op">=</span><span class="st">'Metas por Sexo'</span><span class="op">)</span> <span class="op">+</span> <span class="fu">facet_grid</span><span class="op">(</span><span class="va">Entorno</span><span class="op">~</span><span class="va">.</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="06-chi2_files/figure-html/unnamed-chunk-7-1.png" width="576"></div>
<p>Para hacer lo mismo con <em>SPSS</em>, en el mismo diálogo donde hacíamos <em>tablas cruzadas</em>, pasamos la variable <em>Entornos</em> al campos <em>Capas</em>.</p>
</div>
<div id="limitaciones-de-la-prueba-de-independencia" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Limitaciones de la prueba de independencia<a class="anchor" aria-label="anchor" href="#limitaciones-de-la-prueba-de-independencia"><i class="fas fa-link"></i></a>
</h2>
<p>El contraste de independencia tiene muy pocas limitaciones, aunque es conveniente hacer algunas observaciones:</p>
<ul>
<li><p>Para contrastar la independencia se suele usar el estadístico chi-cuadrado de Pearson. Su cálculo se basa en calcular la diferencia entre las observaciones observadas para cada par de modalidades de las variables (casillas), y las que serían de esperar en caso de que se satisficiese la condición de independencia. Para que se pueda considerar correcta la significación calculada por el estadístico chi-cuadrado de Pearson, se debe cumplir que las frecuencias esperadas no sean muy pequeñas (inferiores a 5) más que en unas pocas casillas. Si es en muchas las casillas donde esto ocurre (más del 20% por ejemplo) se debe usar una prueba que no incluya aproximaciones, como la prueba exacta de Fisher. Esta la ofrece cualquier programa como opción cuando se hace este tipo de contrastes.</p></li>
<li><p>Si las muestras son muy grandes, la prueba de independencia dará resultados significativos incluso donde, posiblemente, consideremos que las diferencias no sean en realidad clínicamente interesantes. Es conveniente una inspección visual para confirmar si las diferencias observadas por filas (o columnas, como prefiramos), nos parecen de interés.</p></li>
<li><p>Si las variables poseen muchos niveles posiblemente la prueba no resulte de mucho interés, ya que es lógico esperar que se encuentren diferencias. Eso ocurre si por ejemplo una de las variables es numérica y no hemos agrupado los posibles valores en una cantidad adecuada de intervalos.</p></li>
<li><p>Si una de las variables es numérica u ordinal, posiblemente queramos hacer algo más que contrastar la simple independencia. Después de todo, esto no es tan informativo como saber que en cierto grupo los valores son significativamente mayores que en otro. Lo aconsejable es usar pruebas de tipo t-student, anova o contrastes no paramétricos comos los que se tratan en otros temas.</p></li>
<li><p>El contraste de chi-cuadrado sirve para contrastar la independencia. No hay que considerarla como una medida de la asociación entre variables. Si buscamos estudiar la asociación de variables tenemos otros métodos a nuestra disposición como regresión logística que trataremos más adelante.</p></li>
</ul>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="diferencias-que-presenta-una-variable-num%C3%A9rica-entre-varios-grupos.html"><span class="header-section-number">5</span> Diferencias que presenta una variable numérica entre varios grupos</a></div>
<div class="next"><a href="regresi%C3%B3n-lineal-m%C3%BAltiple.html"><span class="header-section-number">7</span> Regresión lineal múltiple</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#independencia-de-variables-categ%C3%B3ricas"><span class="header-section-number">6</span> Independencia de variables categóricas</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#ejemploprioridades-en-ni%C3%B1os-y-sexo">Ejemplo:Prioridades en niños y sexo</a></li></ul>
</li>
<li><a class="nav-link" href="#limitaciones-de-la-prueba-de-independencia"><span class="header-section-number">6.1</span> Limitaciones de la prueba de independencia</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/fjbaron/apuntesMaster/blob/master/06-chi2.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/fjbaron/apuntesMaster/edit/master/06-chi2.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Apuntes de estadística</strong>" was written by Francisco Javier Barón López. It was last built on 2022-11-15.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
